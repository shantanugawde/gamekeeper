{% extends "base.html" %}
{% block content %}
<div class="container" style="vertical-align: center;">
    <div style="text-align:center">
        <h2>Access Check</h2>
    </div>
    <hr>
    {% if not isempty %}
    <form class="form-signin" action="" method="post" name="registration">
        {{ form.hidden_tag() }}
        <table class="table table-striped table-hover">
        <tr>
            <th>User</th>
            <th>Resource</th>
            <th>Action</th>
        </tr>
            <td>{{ form.users(class='form-control')  }}</td>
            <td>{{ form.resources(class='form-control')  }}</td>
            <td>{{ form.actions(class='form-control')  }}</td>
        </table>
        <div style="text-align:center; margin-bottom: 20px">
            <button class="btn btn-md btn-primary" type="submit">Check Access</button>
        </div>
        {% if g.acc_status == "true" %}
        <div class="alert alert-success" role="alert">Access is allowed for the selected combination</div>
        {% endif %}
        {% if g.acc_status == "false" %}
        <div class="alert alert-danger" role="alert">Access is not allowed for the selected combination</div>
        {% endif %}
    </form>
    {% else %}
    <div style="text-align:center">
        <h3>Add <a href="{{url_for('addresource')}}">resources</a> and <a href="{{url_for('registration')}}">users</a> before performing access check</h3>
    </div>
    {% endif %}
</div> <!-- /container -->
{% endblock %}
